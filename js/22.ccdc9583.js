(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{"13f2":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"row q-mt-xl q-pt-xl justify-center"},[s("q-table",{staticStyle:{width:"55vw"},attrs:{title:"商品資料",data:e.products,columns:e.columns,"row-key":"name"},on:{"row-dblclick":e.getProductDetail},scopedSlots:e._u([{key:"header-selection",fn:function(t){return[s("q-toggle",{model:{value:t.selected,callback:function(s){e.$set(t,"selected",s)},expression:"scope.selected"}})]}},{key:"body-selection",fn:function(t){return[s("q-toggle",{model:{value:t.selected,callback:function(s){e.$set(t,"selected",s)},expression:"scope.selected"}})]}}])})],1),s("div",{staticClass:"row q-my-lg justify-center"},[s("q-btn",{attrs:{flat:"",label:"新增商品",color:"primary"},on:{click:e.addProduct}})],1),e.ProductDetails.name?s("div",{staticClass:"row q-mb-lg justify-center"},[e._m(0),s("div",{staticClass:"col-12 flex justify-center"},[s("div",{staticClass:"row",staticStyle:{width:"700px"}},[s("div",{staticClass:"col q-ml-sm q-mr-xl"},[s("img",{staticStyle:{width:"100%"},attrs:{src:e.ProductDetails.image}})]),s("div",{staticClass:"col",staticStyle:{"font-size":"1.5rem"}},[s("div",{staticClass:"row"},[e._v(e._s(e.ProductDetails.name))]),s("div",{staticClass:"row"},[e._v("$ "+e._s(e.ProductDetails.price))]),s("div",{staticClass:"row q-my-md",staticStyle:{"font-size":"1rem"}},[e._v(e._s(e.ProductDetails.description))]),s("div",{staticClass:"row",staticStyle:{"font-size":"1rem"}},[e._v("提供尺寸："+e._s(e.ProductDetails.size))])])])]),s("div",{staticClass:"col-12 q-my-lg text-center"},[s("q-btn",{staticClass:"text-primary",attrs:{flat:""},on:{click:e.editProduct}},[e._v("編輯商品")])],1)]):e._e(),s("q-dialog",{model:{value:e.alert,callback:function(t){e.alert=t},expression:"alert"}},[s("q-card",{staticClass:"q-pa-md"},[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v(e._s(e.mode))])]),s("q-card-section",{staticClass:"q-pt-none"},[s("q-input",{attrs:{label:"商品標題"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),s("q-input",{attrs:{label:"商品價格",prefix:"$"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}}),s("q-input",{attrs:{label:"商品描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}),s("q-select",{attrs:{multiple:"",options:e.options,label:"提供尺寸"},model:{value:e.form.size,callback:function(t){e.$set(e.form,"size",t)},expression:"form.size"}}),s("q-input",{attrs:{label:"販售商家"},model:{value:e.form.seller,callback:function(t){e.$set(e.form,"seller",t)},expression:"form.seller"}})],1),s("q-card-section",[s("img-inputer",{staticStyle:{width:"100%"},attrs:{placeholder:"點擊或拖曳選擇圖片","bottom-text":"點擊或拖曳以修改",size:"large",theme:"dark","img-src":e.form.image},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1),s("q-card-actions",{staticClass:"justify-around"},["編輯商品"===e.mode?s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-negative",staticStyle:{width:"80px"},attrs:{flat:"",label:"下架",value:!1},on:{click:e.submitModal},model:{value:e.form.sell,callback:function(t){e.$set(e.form,"sell",t)},expression:"form.sell"}}):e._e(),(e.mode,e._e()),s("q-btn",{staticStyle:{width:"80px"},attrs:{flat:"",label:"取消",color:"primary"},on:{click:e.resetForm}}),s("q-btn",{staticStyle:{width:"80px"},attrs:{flat:"",label:"確認",color:"primary"},on:{click:e.submitModal}})],1)],1)],1)],1)},l=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"col-12"},[s("hr",{staticClass:"q-mb-xl",staticStyle:{width:"55vw"}})])}],a=(s("e01a"),s("ddb0"),s("758b")),r={data(){return{columns:[{name:"name",required:!0,label:"商品名稱",align:"left",field:"name",sortable:!0},{name:"price",align:"left",label:"價格",field:"price",sortable:!0},{name:"sell",align:"left",label:"販售狀態",field:"sell"},{name:"id",align:"center",label:"_id",field:"_id",sortable:!0}],products:[],alert:!1,mode:"",confirm:!1,prompt:!1,address:"",options:["xs","sm","md","lg","xl","固定尺寸"],submitDisable:!1,form:{name:"",price:"",description:"",size:null,seller:"",image:"",sell:"",_id:""},ProductDetails:{name:"",price:"",description:"",size:null,seller:"",image:"",sell:"",_id:""}}},methods:{addProduct(){this.mode="新增商品",this.form={name:"",price:"",description:"",size:null,seller:"",image:"",sell:""},this.alert=!0},editProduct(e){this.mode="編輯商品",this.form={name:this.ProductDetails.name,price:this.ProductDetails.price,description:this.ProductDetails.description,size:this.ProductDetails.size,seller:this.ProductDetails.seller,image:this.ProductDetails.image,sell:this.ProductDetails.sell,_id:this.ProductDetails._id,index:e},this.alert=!0},resetForm(e){this.submitDisable?e.preventDefault():(this.alert=!1,this.form={name:"",price:"",description:"",size:null,seller:"",image:"",sell:"",_id:""})},async submitModal(){this.submitDisable=!0;try{const e=new FormData;for(const t in this.form)if(Array.isArray(this.form[t]))for(const s of this.form[t])e.append(t,s);else e.append(t,this.form[t]);await a["a"].post("/products",e,{headers:{authorization:"Bearer "+this.$store.state.user.jwt.token}}),this.alert=!1,this.$swal({icon:"success",title:"成功",text:"新增商品成功"}),this.form={name:"",price:"",description:"",size:null,seller:"",image:"",sell:"",_id:""}}catch(e){this.alert=!1,this.$swal({icon:"error",title:"錯誤",text:e.response.data.message})}this.submitDisable=!1},async getProductDetail(e,t,s){try{const{data:e}=await a["a"].get("/products/"+this.products[s]._id);e.result.image&&(e.result.image=`https://festivalsweb.herokuapp.com//files/${e.result.image}`),this.ProductDetails=e.result}catch(i){this.$swal({icon:"error",title:"取得指定商品錯誤",text:i.response.data.message})}}},async mounted(){try{const{data:e}=await a["a"].get("/products/all");this.products=e.result.map((e=>(e.image&&(e.image=`https://festivalsweb.herokuapp.com//files/${e.image}`),e.sell?e.sell="販售中":e.sell="未上架",e.price=`$ ${e.price}`,e)))}catch(e){this.$swal({icon:"error",title:"錯誤",text:"取得商品失敗"})}}},o=r,c=s("2877"),n=s("eaac"),d=s("9564"),m=s("9c40"),u=s("24e8"),p=s("f09f"),f=s("a370"),h=s("27f9"),b=s("ddd8"),g=s("4b7e"),v=s("7f67"),w=s("eebe"),y=s.n(w),x=Object(c["a"])(o,i,l,!1,null,null,null);t["default"]=x.exports;y()(x,"components",{QTable:n["a"],QToggle:d["a"],QBtn:m["a"],QDialog:u["a"],QCard:p["a"],QCardSection:f["a"],QInput:h["a"],QSelect:b["a"],QCardActions:g["a"]}),y()(x,"directives",{ClosePopup:v["a"]})}}]);